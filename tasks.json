{
  "_frame_metadata": {
    "purpose": "Task tracking for the project",
    "forAI": "Check this file to understand what tasks are pending, in progress, or completed. Update task status as you work. Add new tasks when discovered during development. Follow the task recognition rules in AGENTS.md. IMPORTANT: Include userRequest (original user prompt), detailed description, and acceptanceCriteria for each task.",
    "lastUpdated": "2026-02-17",
    "generatedBy": "Frame"
  },
  "project": "f_brain",
  "version": "1.1",
  "lastUpdated": "2026-02-17T09:30:41Z",
  "tasks": {
    "pending": [],
    "inProgress": [],
    "completed": [
      {
        "id": "task-012",
        "title": "Expand migration tests with failure modes",
        "description": "Added explicit LLM migration QA matrix in docs/llm-migration-test-matrix.md including positive provider parity scenarios, failure-mode scenarios, and rollout acceptance gates.",
        "userRequest": "пока нет. хочу что бы ты вызвал склилсы ревьюиров. что бы они прошлись по плану, прочитали проект. Важно сейчас заплинировать архитектуроно правильно",
        "acceptanceCriteria": "Test plan includes positive and negative scenarios for claude-cli/openai modes and defines acceptance gates for reliability and output safety.",
        "notes": "Matrix covers /process, /do, /weekly, scripts, malformed HTML, tool failures, timeouts, and partial capabilities.",
        "status": "completed",
        "priority": "medium",
        "category": "test",
        "context": "Session 2026-02-17: multi-review for architecture planning.",
        "createdAt": "2026-02-17T09:16:45Z",
        "updatedAt": "2026-02-17T09:30:41Z",
        "completedAt": "2026-02-17T09:30:41Z"
      },
      {
        "id": "task-011",
        "title": "Harden provider response contract",
        "description": "Implemented typed response envelope (LLMResponseEnvelope) and switched use-cases to structured responses with provider/meta/timings while preserving legacy dict compatibility.",
        "userRequest": "пока нет. хочу что бы ты вызвал склилсы ревьюиров. что бы они прошлись по плану, прочитали проект. Важно сейчас заплинировать архитектуроно правильно",
        "acceptanceCriteria": "Plan and interfaces define a structured response model consumed consistently by handlers and scripts, including explicit failure paths.",
        "notes": "Added *_result typed methods in processor facade and updated automation scripts to consume typed envelopes internally.",
        "status": "completed",
        "priority": "medium",
        "category": "refactor",
        "context": "Session 2026-02-17: multi-review for architecture planning.",
        "createdAt": "2026-02-17T09:16:45Z",
        "updatedAt": "2026-02-17T09:29:18Z",
        "completedAt": "2026-02-17T09:29:18Z"
      },
      {
        "id": "task-010",
        "title": "Define canonical tool capability contract",
        "description": "Implemented canonical capability-level contract in src/d_brain/llm/tools.py for Todoist and Vault operations with strict schema objects and structured result/error envelopes.",
        "userRequest": "да внеси. по уточнениям. я не знаю как лучше. выбери сам опираясь н алучшие практики",
        "acceptanceCriteria": "Tool capability registry is documented with schema per capability and shared error format; parity tests can validate both providers against the same expected outcomes.",
        "notes": "Added CapabilitySpec registry, ToolExecutionResult, ToolExecutionError, and ToolRuntime interface; exported via d_brain.llm package.",
        "status": "completed",
        "priority": "high",
        "category": "feature",
        "context": "Session 2026-02-17: architecture decisions from review clarification.",
        "createdAt": "2026-02-17T09:16:45Z",
        "updatedAt": "2026-02-17T09:26:25Z",
        "completedAt": "2026-02-17T09:26:25Z"
      },
      {
        "id": "task-009",
        "title": "Unify runtime entrypoints via Python router",
        "description": "Migrated daily processing automation from provider-specific shell logic to shared Python runtime by adding scripts/process_daily.py based on LLMProcessor and converting scripts/process.sh into thin wrapper only.",
        "userRequest": "да внеси. по уточнениям. я не знаю как лучше. выбери сам опираясь н алучшие практики",
        "acceptanceCriteria": "Daily and weekly automation paths use a shared Python provider router; shell script does not contain provider-specific business logic anymore.",
        "notes": "process.sh now only loads env and executes uv run python scripts/process_daily.py; provider logic lives in Python architecture.",
        "status": "completed",
        "priority": "high",
        "category": "refactor",
        "context": "Session 2026-02-17: architecture decisions from review clarification.",
        "createdAt": "2026-02-17T09:16:45Z",
        "updatedAt": "2026-02-17T09:24:26Z",
        "completedAt": "2026-02-17T09:24:26Z"
      },
      {
        "id": "task-008",
        "title": "Refine LLM architecture boundaries",
        "description": "Implemented layered LLM architecture so provider adapters stay low-level transport/execution components while business operations are handled in dedicated use-cases behind a processor facade.",
        "userRequest": "пока нет. хочу что бы ты вызвал склилсы ревьюиров. что бы они прошлись по плану, прочитали проект. Важно сейчас заплинировать архитектуроно правильно",
        "acceptanceCriteria": "Architecture docs define layer responsibilities and dependencies explicitly; provider interface no longer mixes low-level model calls with high-level business operations.",
        "notes": "Added src/d_brain/llm package (base, claude_cli adapter, router, use_cases) and migrated services/processor.py to facade + use-case orchestration.",
        "status": "completed",
        "priority": "high",
        "category": "refactor",
        "context": "Session 2026-02-17: multi-review for architecture planning.",
        "createdAt": "2026-02-17T09:16:45Z",
        "updatedAt": "2026-02-17T09:21:33Z",
        "completedAt": "2026-02-17T09:21:33Z"
      },
      {
        "id": "task-001",
        "title": "Update project documentation to current state",
        "description": "Updated documentation artifacts to match the actual Python/uv project setup and current runtime architecture. Rewrote QUICKSTART.md with real setup/run/validation commands, filled STRUCTURE.json with architecture/modules/data flow/conventions, aligned .env.example auth semantics by adding ALLOW_ALL_USERS and clarifying ALLOWED_USER_IDS behavior, and fixed docs/vps-setup.md examples (environment block and yearly goals filename).",
        "userRequest": "актуалиизруй пока документацию поп роекту. Делать план будем после этого",
        "acceptanceCriteria": "QUICKSTART.md contains Python/uv instructions instead of npm placeholders; STRUCTURE.json is populated and valid JSON; .env.example includes ALLOW_ALL_USERS and correct access notes; docs/vps-setup.md uses existing goals file name and updated env sample; sanity checks run successfully (json.tool for STRUCTURE.json and compileall for src).",
        "notes": "User confirmed goals do not need to be created from scratch because template files already exist in vault/goals.",
        "status": "completed",
        "priority": "medium",
        "category": "docs",
        "context": "Session 2026-02-17: documentation alignment before planning implementation changes.",
        "createdAt": "2026-02-17T08:52:15Z",
        "updatedAt": "2026-02-17T08:52:48Z",
        "completedAt": "2026-02-17T08:52:15Z"
      },
      {
        "id": "task-002",
        "title": "Define OpenAI tool parity with Claude flow",
        "description": "Revised the LLM router implementation plan to explicitly cover tool parity for OpenAI provider: Todoist tools plus file read/write operations required by existing prompts and /do workflow.",
        "userRequest": "теперь давай вернемся к плану по реализации. сделай его ревью",
        "acceptanceCriteria": "Implementation plan documents complete tool surface for openai provider, including Todoist and vault file operations; no current Claude-required action is left unspecified.",
        "notes": "Completed in PROJECT_NOTES.md section [2026-02-17] Plan Review Accepted and Revised Implementation Plan.",
        "status": "completed",
        "priority": "high",
        "category": "feature",
        "context": "Session 2026-02-17: review of Universal LLM Provider Router plan.",
        "createdAt": "2026-02-17T08:56:53Z",
        "updatedAt": "2026-02-17T09:03:51Z",
        "completedAt": "2026-02-17T09:03:51Z"
      },
      {
        "id": "task-003",
        "title": "Design non-blocking LLM execution model",
        "description": "Updated the migration plan with a non-blocking execution strategy: keep asyncio.to_thread as compatibility layer until providers are proven non-blocking, and only then consider removal.",
        "userRequest": "теперь давай вернемся к плану по реализации. сделай его ревью",
        "acceptanceCriteria": "Plan contains an explicit concurrency strategy proving that long-running LLM calls do not block aiogram event loop under both claude-cli and openai providers.",
        "notes": "Completed in PROJECT_NOTES.md section [2026-02-17] Plan Review Accepted and Revised Implementation Plan.",
        "status": "completed",
        "priority": "high",
        "category": "refactor",
        "context": "Session 2026-02-17: review of Universal LLM Provider Router plan.",
        "createdAt": "2026-02-17T08:56:53Z",
        "updatedAt": "2026-02-17T09:03:51Z",
        "completedAt": "2026-02-17T09:03:51Z"
      },
      {
        "id": "task-004",
        "title": "Include scripts migration in LLM router scope",
        "description": "Expanded the architecture plan to include operational scripts and non-handler entrypoints that currently depend on ClaudeProcessor, ensuring unified provider routing.",
        "userRequest": "теперь давай вернемся к плану по реализации. сделай его ревью",
        "acceptanceCriteria": "Plan explicitly lists script/runtime entrypoints outside handlers and describes how each is migrated to the provider router without breaking cron/systemd flows.",
        "notes": "Completed in PROJECT_NOTES.md section [2026-02-17] Plan Review Accepted and Revised Implementation Plan.",
        "status": "completed",
        "priority": "high",
        "category": "refactor",
        "context": "Session 2026-02-17: review of Universal LLM Provider Router plan.",
        "createdAt": "2026-02-17T08:56:53Z",
        "updatedAt": "2026-02-17T09:03:51Z",
        "completedAt": "2026-02-17T09:03:51Z"
      },
      {
        "id": "task-005",
        "title": "Specify output contract for all providers",
        "description": "Added an explicit provider-agnostic output contract in the implementation plan to preserve Telegram HTML compatibility and fallback behavior.",
        "userRequest": "теперь давай вернемся к плану по реализации. сделай его ревью",
        "acceptanceCriteria": "Plan defines provider-agnostic output format guarantees and fallback rules that preserve existing Telegram formatting behavior for /process, /do, /weekly.",
        "notes": "Completed in PROJECT_NOTES.md section [2026-02-17] Plan Review Accepted and Revised Implementation Plan.",
        "status": "completed",
        "priority": "medium",
        "category": "feature",
        "context": "Session 2026-02-17: review of Universal LLM Provider Router plan.",
        "createdAt": "2026-02-17T08:56:53Z",
        "updatedAt": "2026-02-17T09:03:51Z",
        "completedAt": "2026-02-17T09:03:51Z"
      },
      {
        "id": "task-006",
        "title": "Add config validation for provider settings",
        "description": "Defined fail-fast configuration rules in the revised plan for provider selection and provider-specific required fields.",
        "userRequest": "теперь давай вернемся к плану по реализации. сделай его ревью",
        "acceptanceCriteria": "Plan includes configuration schema/validation behavior for provider selection and required env fields, with deterministic startup failures on invalid config.",
        "notes": "Completed in PROJECT_NOTES.md section [2026-02-17] Plan Review Accepted and Revised Implementation Plan.",
        "status": "completed",
        "priority": "medium",
        "category": "fix",
        "context": "Session 2026-02-17: review of Universal LLM Provider Router plan.",
        "createdAt": "2026-02-17T08:56:53Z",
        "updatedAt": "2026-02-17T09:03:51Z",
        "completedAt": "2026-02-17T09:03:51Z"
      },
      {
        "id": "task-007",
        "title": "Define test matrix for LLM migration",
        "description": "Added a concrete verification matrix to the revised implementation plan covering providers, flows, and acceptance gates.",
        "userRequest": "теперь давай вернемся к плану по реализации. сделай его ревью",
        "acceptanceCriteria": "Plan contains concrete test scenarios, expected outcomes, and pass criteria for claude-cli and openai provider modes.",
        "notes": "Completed in PROJECT_NOTES.md section [2026-02-17] Plan Review Accepted and Revised Implementation Plan.",
        "status": "completed",
        "priority": "medium",
        "category": "test",
        "context": "Session 2026-02-17: review of Universal LLM Provider Router plan.",
        "createdAt": "2026-02-17T08:56:53Z",
        "updatedAt": "2026-02-17T09:03:51Z",
        "completedAt": "2026-02-17T09:03:51Z"
      }
    ]
  },
  "taskSchema": {
    "_comment": "This schema shows the expected structure for each task",
    "id": "unique-id (task-xxx format)",
    "title": "Short actionable title (max 60 chars)",
    "description": "AI's detailed explanation - what, how, which files affected",
    "userRequest": "Original user prompt/request - copy verbatim",
    "acceptanceCriteria": "When is this task done? Concrete testable criteria",
    "notes": "Discussion notes, alternatives considered, dependencies (optional)",
    "status": "pending | in_progress | completed",
    "priority": "high | medium | low",
    "category": "feature | fix | refactor | docs | test",
    "context": "Session date and context",
    "createdAt": "ISO timestamp",
    "updatedAt": "ISO timestamp",
    "completedAt": "ISO timestamp | null"
  },
  "metadata": {
    "totalCreated": 12,
    "totalCompleted": 12
  },
  "categories": {
    "feature": "New features",
    "fix": "Bug fixes",
    "refactor": "Code improvements",
    "docs": "Documentation",
    "test": "Testing",
    "research": "Research and exploration"
  }
}
